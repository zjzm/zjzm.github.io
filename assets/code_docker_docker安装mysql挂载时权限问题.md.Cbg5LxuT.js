import{_ as s,c as a,o as n,a4 as i}from"./chunks/framework.qL1yNBZ5.js";const p="/docker/image-1716389347412.png",e="/docker/image-1716389671531.png",y=JSON.parse('{"title":"","description":"","frontmatter":{"typora-copy-images-to":"./..\\\\..\\\\public\\\\docker","typora-root-url":"./..\\\\..\\\\public"},"headers":[],"relativePath":"code/docker/docker安装mysql挂载时权限问题.md","filePath":"code/docker/docker安装mysql挂载时权限问题.md"}'),t={name:"code/docker/docker安装mysql挂载时权限问题.md"},l=i('<p>最近遇到一个问题 <img src="'+p+'" alt="file"> 百度之后发现是挂载目录的权限问题,说是需要挂载目录各自对应的用户组ID需要保持一致</p><ul><li>查出来容器里的mysql用户组id</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -ti</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --entrypoint=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/bin/bash&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 镜像名</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;cat /etc/group&quot;</span></span></code></pre></div><p>可以看到以下信息 <img src="'+e+`" alt="file"></p><p>这时我们可以知道mysql镜像容器的用户组id为999,所以我们把挂载目录的用户组ID也改为999</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 999</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/data</span></span></code></pre></div><p>需要将镜像中的mysql用户组id和宿主机中的当前用户组id保持一致</p><div class="language-docker-compose vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">docker-compose</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  mysql:</span></span>
<span class="line"><span>    image: mysql:5.7</span></span>
<span class="line"><span>    restart: always</span></span>
<span class="line"><span>    command: --default-authentication-plugin=mysql_native_password</span></span>
<span class="line"><span>    ports:</span></span>
<span class="line"><span>      - &quot;3306:3306&quot;</span></span>
<span class="line"><span>    #左侧为容器中要改的用户组id 右侧为容器修改后的用户组id  </span></span>
<span class="line"><span>    user: &quot;999:1000&quot; </span></span>
<span class="line"><span>    volumes:</span></span>
<span class="line"><span>      - ./services/mysql:/var/lib/mysql</span></span>
<span class="line"><span>      - ./services/mysql5.7/cnf/my.cnf:/etc/mysql/my.cnf</span></span>
<span class="line"><span>    environment:</span></span>
<span class="line"><span>        MYSQL_ROOT_PASSWORD: ********</span></span>
<span class="line"><span>        TZ: Asia/Shanghai</span></span>
<span class="line"><span>    networks:</span></span>
<span class="line"><span>      - lnmp-network</span></span>
<span class="line"><span>    container_name: mysql</span></span></code></pre></div>`,8),c=[l];function o(d,r,h,k,m,_){return n(),a("div",null,c)}const u=s(t,[["render",o]]);export{y as __pageData,u as default};
