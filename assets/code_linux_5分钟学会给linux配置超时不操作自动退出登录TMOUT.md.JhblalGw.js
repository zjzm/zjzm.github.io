import{_ as s,c as i,o as a,a4 as e}from"./chunks/framework.qL1yNBZ5.js";const b=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"code/linux/5分钟学会给linux配置超时不操作自动退出登录TMOUT.md","filePath":"code/linux/5分钟学会给linux配置超时不操作自动退出登录TMOUT.md"}'),t={name:"code/linux/5分钟学会给linux配置超时不操作自动退出登录TMOUT.md"},p=e(`<h2 id="超时不操作自动退出登录" tabindex="-1">超时不操作自动退出登录 <a class="header-anchor" href="#超时不操作自动退出登录" aria-label="Permalink to &quot;超时不操作自动退出登录&quot;">​</a></h2><p>系统为CentOS 7，一次无意操作在/etc/profile末尾增加了TMOUT=90,然后系统就总是一会没操作就自动退出登录，不仅ssh自动退出，在本地使用也自动退出，很麻烦，查了一下，原来是启动了系统空闲等待时间，TMOUT=90意思是90秒无操作就自动退出登录。</p><h3 id="_1-取消系统空闲等待时间" tabindex="-1">1 取消系统空闲等待时间 <a class="header-anchor" href="#_1-取消系统空闲等待时间" aria-label="Permalink to &quot;1 取消系统空闲等待时间&quot;">​</a></h3><p>然后我需要取消这个设置，既然我是在/etc/profile中增加了TMOUT=90，那么我把它删除掉不就行了？<br> 删除了之后，使/etc/profile配置文件生效</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/profile</span></span></code></pre></div><p>退出登录</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">logout</span></span></code></pre></div><p>重新登陆，然而，过了一会儿，还是会自动退出登录，查看set</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set</span></span></code></pre></div><p>发现结果中有一项：TMOUT=90，然后我用unset命令取消TMOUT</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">unset</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TMOUT</span></span></code></pre></div><p>重新登录后再次查看set结果，发现结果中还是有一项：TMOUT=90，查看 /etc/profile 文件， /etc/profile 文件中没有TMOUT配置。但是系统还是会自动退出登录，烦烦烦，然后使用如下命令:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TMOUT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9999999</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">readonly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TMOUT</span></span></code></pre></div><p>然而并没有什么用，重新登录后查看set结果，还是TMOUT=90，还是会自动退出登录！！！！<br> 最终，我把上面的两行命令写到/etc/profilez的末尾，</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/profile</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#打开文件后，在末尾增加下面两行内容，然后保存退出。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TMOUT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    #0代表永不自动退出</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">readonly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TMOUT   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 将值设置为readonly 防止用户更改，在shell中无法修改TMOUT</span></span></code></pre></div><p>然后退出登陆，再次登录，再次查看set结果，发现结果中有一项为</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TMOUT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0</span></span></code></pre></div><p>OMG！！！！！！终于成功了，再也没有自动退出的现象了。</p><h3 id="_2-设置系统空闲等待时间" tabindex="-1">2 设置系统空闲等待时间 <a class="header-anchor" href="#_2-设置系统空闲等待时间" aria-label="Permalink to &quot;2 设置系统空闲等待时间&quot;">​</a></h3><p>反之，如果想让系统超时未操作自动退出登录，可以修改/etc/profile文件</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TMOUT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">600</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   #600秒无操作自动退出登录</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">readonly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TMOUT# 将值设置为readonly 防止用户更改，在shell中无法修改TMOUT</span></span></code></pre></div><p>也可以通过命令的方式设置，在shell中输入如下代码即可实现600秒无操作自动退出登录：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TMOUT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">600</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">readonly</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TMOUT</span></span></code></pre></div><p>如果之前已经在/etc/profile文件中设置了readonly TMOUT ，需要先将/etc/profile文件中的readonly TMOUT 注释掉或删除掉，再输入上面的命令。</p>`,24),n=[p];function l(h,d,k,o,c,r){return a(),i("div",null,n)}const u=s(t,[["render",l]]);export{b as __pageData,u as default};
